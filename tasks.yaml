includes:
  - ci: test/tasks/ci.yaml
  - test: test/tasks/test.yaml

tasks:
  - name: clean
    description: Clean the repo of all build/test artifacts
    actions:
      - cmd: rm -f zarf-config.yaml
      - cmd: rm -f *.tar.zst
      - cmd: rm -rf test/zarf-sbom
      - cmd: rm -f test/workflows/*.tar.zst
  - name: build-package
    description: Builds the production-level zarf package to deploy vanilla argo workflows
    actions:
      - cmd: uds zarf package create --confirm --flavor vanilla
  - name: deploy-package
    description: Deploys the zarf package
    actions:
      - cmd: |
          uds zarf -l debug --no-log-file package deploy \
          zarf-package-argo-workflows-*.tar.zst --confirm
  - name: test
    description: Run the full end-to-end test suite
    actions:
      - task: clean
      - task: ci:up
      - task: test:package-up
      - task: test:submit-workflow
      - task: ci:down
  - name: foo
    actions:
      - task: test:package-up